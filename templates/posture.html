{% extends "base.html" %}

{% block title %}Sant√© Posturale - D√©fi Decathlon{% endblock %}

{% block extra_css %}
<style>
    .posture-hero {
        background: linear-gradient(135deg, #FF6B35, #FF8C42);
        color: white;
        padding: 4rem 2rem;
        text-align: center;
        border-radius: 20px;
        margin-bottom: 3rem;
        box-shadow: 0 10px 40px rgba(255, 107, 53, 0.3);
    }

    .posture-hero h1 {
        font-size: 3rem;
        margin-bottom: 1rem;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .level-selector {
        display: flex;
        gap: 1rem;
        justify-content: center;
        margin: 2rem 0;
        flex-wrap: wrap;
    }

    .level-btn {
        background: white;
        border: 3px solid #E2E8F0;
        color: #2D3748;
        padding: 1rem 2rem;
        border-radius: 15px;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: bold;
        font-size: 1.1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .level-btn:hover {
        border-color: #FF6B35;
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
    }

    .level-btn.active {
        background: linear-gradient(135deg, #FF6B35, #FF8C42);
        color: white;
        border-color: #FF6B35;
    }

    .level-btn.completed {
        background: #8BC34A;
        color: white;
        border-color: #8BC34A;
    }

    .level-section {
        display: none;
        background: white;
        border-radius: 20px;
        padding: 3rem;
        margin-bottom: 2rem;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }

    .level-section.active {
        display: block;
        animation: fadeInUp 0.5s;
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .qcm-question {
        background: #F7FAFC;
        border-left: 5px solid #FF6B35;
        padding: 2rem;
        border-radius: 10px;
        margin-bottom: 2rem;
    }

    .qcm-options {
        display: grid;
        gap: 1rem;
        margin-top: 1.5rem;
    }

    .qcm-option {
        background: white;
        border: 2px solid #E2E8F0;
        padding: 1.5rem;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .qcm-option:hover {
        border-color: #FF6B35;
        transform: translateX(10px);
    }

    .qcm-option.selected {
        border-color: #8BC34A;
        background: rgba(139, 195, 74, 0.1);
    }

    .qcm-option input[type="radio"] {
        width: 20px;
        height: 20px;
        accent-color: #FF6B35;
    }

    .exercise-card {
        background: linear-gradient(135deg, #F7FAFC, #EDF2F7);
        border: 3px solid #FF6B35;
        border-radius: 15px;
        padding: 2rem;
        margin-bottom: 2rem;
    }

    .exercise-card h3 {
        color: #FF6B35;
        font-size: 1.8rem;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .instruction-step {
        background: white;
        border-left: 4px solid #8BC34A;
        padding: 1.5rem;
        margin-bottom: 1rem;
        border-radius: 8px;
    }

    .instruction-step strong {
        color: #FF6B35;
        font-size: 1.2rem;
    }

    .posture-visual {
        display: flex;
        gap: 2rem;
        margin: 2rem 0;
        flex-wrap: wrap;
        justify-content: center;
    }

    .posture-image {
        background: white;
        border: 3px solid #E2E8F0;
        border-radius: 15px;
        padding: 1.5rem;
        text-align: center;
        flex: 1;
        min-width: 250px;
        max-width: 350px;
    }

    .posture-image.correct {
        border-color: #8BC34A;
    }

    .posture-image.incorrect {
        border-color: #E74C3C;
    }

    .posture-svg {
        width: 200px;
        height: 300px;
        margin: 1rem auto;
    }

    .product-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
        margin-top: 2rem;
    }

    .product-card {
        background: white;
        border: 2px solid #E2E8F0;
        border-radius: 15px;
        padding: 1.5rem;
        text-align: center;
        transition: all 0.3s;
    }

    .product-card:hover {
        border-color: #FF6B35;
        transform: translateY(-10px);
        box-shadow: 0 10px 30px rgba(255, 107, 53, 0.2);
    }

    .product-image {
        width: 100%;
        height: 200px;
        background: linear-gradient(135deg, #F7FAFC, #EDF2F7);
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 4rem;
        margin-bottom: 1rem;
    }

    .product-price {
        color: #FF6B35;
        font-size: 1.5rem;
        font-weight: bold;
        margin: 1rem 0;
    }

    .btn-decathlon {
        background: linear-gradient(135deg, #FF6B35, #FF8C42);
        color: white;
        padding: 1rem 2rem;
        border-radius: 30px;
        border: none;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
        display: inline-block;
        text-decoration: none;
    }

    .btn-decathlon:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(255, 107, 53, 0.4);
    }

    .profile-summary {
        background: linear-gradient(135deg, #8BC34A, #558B2F);
        color: white;
        padding: 2rem;
        border-radius: 15px;
        margin: 2rem 0;
    }

    .profile-summary h3 {
        color: white;
        margin-bottom: 1rem;
    }

    .alert-posture {
        background: #FFF3CD;
        border: 3px solid #FFC107;
        border-radius: 10px;
        padding: 1.5rem;
        margin: 2rem 0;
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .alert-posture .icon {
        font-size: 2.5rem;
    }

    .video-placeholder {
        width: 100%;
        height: 400px;
        background: linear-gradient(135deg, #2D3748, #1A202C);
        border-radius: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.5rem;
        margin: 2rem 0;
    }

    @media (max-width: 768px) {
        .posture-hero h1 {
            font-size: 2rem;
        }
        
        .level-selector {
            flex-direction: column;
        }
        
        .level-btn {
            width: 100%;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="posture-hero">
    <h1>üèãÔ∏è CTO de Votre Sant√© Posturale</h1>
    <p style="font-size: 1.3rem;">D√©fi Decathlon x NIRD Quest</p>
    <p style="font-size: 1.1rem; margin-top: 1rem;">
        Comme on pr√¥ne la <strong>durabilit√© du mat√©riel</strong>, prenons soin de la <strong>durabilit√© de notre corps</strong> !
    </p>
</div>

<div class="card">
    <h2>üéØ Les 4 Niveaux du D√©fi</h2>
    <div class="level-selector">
        <button class="level-btn active" onclick="showLevel(1)">
            <span>1Ô∏è‚É£</span>
            <span>Profilage Sportif</span>
        </button>
        <button class="level-btn" onclick="showLevel(2)" id="btn-level-2">
            <span>2Ô∏è‚É£</span>
            <span>Instructions</span>
        </button>
        <button class="level-btn" onclick="showLevel(3)" id="btn-level-3">
            <span>3Ô∏è‚É£</span>
            <span>Visualisation</span>
        </button>
        <button class="level-btn" onclick="showLevel(4)" id="btn-level-4">
            <span>4Ô∏è‚É£</span>
            <span>Produits Decathlon</span>
        </button>
    </div>
</div>

<!-- NIVEAU 1 : PROFILAGE -->
<div class="level-section active" id="level-1">
    <h2 style="color: #FF6B35;">1Ô∏è‚É£ Niveau 1 : Profilage Sportif</h2>
    <p style="font-size: 1.1rem; color: #4A5568; margin-bottom: 2rem;">
        Commen√ßons par √©tablir votre profil sportif pour personnaliser vos recommandations.
    </p>

    <div class="qcm-question">
        <h3>Question 1 : Quel est votre niveau sportif actuel ?</h3>
        <div class="qcm-options">
            <label class="qcm-option">
                <input type="radio" name="q1" value="debutant" onclick="saveAnswer('niveau', 'debutant')">
                <div>
                    <strong>üå± D√©butant</strong>
                    <p style="margin: 0; color: #718096;">Je commence tout juste ou je reprends apr√®s une longue pause</p>
                </div>
            </label>
            <label class="qcm-option">
                <input type="radio" name="q1" value="intermediaire" onclick="saveAnswer('niveau', 'intermediaire')">
                <div>
                    <strong>üí™ Interm√©diaire</strong>
                    <p style="margin: 0; color: #718096;">Je pratique r√©guli√®rement (1-3x/semaine)</p>
                </div>
            </label>
            <label class="qcm-option">
                <input type="radio" name="q1" value="avance" onclick="saveAnswer('niveau', 'avance')">
                <div>
                    <strong>üèÜ Avanc√©</strong>
                    <p style="margin: 0; color: #718096;">Je m'entra√Æne intens√©ment (4x+/semaine)</p>
                </div>
            </label>
        </div>
    </div>

    <div class="qcm-question">
        <h3>Question 2 : Quels sports pratiquez-vous ? (plusieurs choix possibles)</h3>
        <div class="qcm-options">
            <label class="qcm-option">
                <input type="checkbox" name="sport" value="musculation" onclick="saveSport('musculation')">
                <span>üèãÔ∏è Musculation / Fitness</span>
            </label>
            <label class="qcm-option">
                <input type="checkbox" name="sport" value="yoga" onclick="saveSport('yoga')">
                <span>üßò Yoga / Pilates</span>
            </label>
            <label class="qcm-option">
                <input type="checkbox" name="sport" value="course" onclick="saveSport('course')">
                <span>üèÉ Course √† pied</span>
            </label>
            <label class="qcm-option">
                <input type="checkbox" name="sport" value="velo" onclick="saveSport('velo')">
                <span>üö¥ Cyclisme</span>
            </label>
            <label class="qcm-option">
                <input type="checkbox" name="sport" value="natation" onclick="saveSport('natation')">
                <span>üèä Natation</span>
            </label>
        </div>
    </div>

    <div class="qcm-question">
        <h3>Question 3 : Quel est votre objectif principal ?</h3>
        <div class="qcm-options">
            <label class="qcm-option">
                <input type="radio" name="q3" value="forme" onclick="saveAnswer('objectif', 'forme')">
                <span>üíö Rester en forme et en bonne sant√©</span>
            </label>
            <label class="qcm-option">
                <input type="radio" name="q3" value="muscle" onclick="saveAnswer('objectif', 'muscle')">
                <span>üí™ Gagner en force et en muscle</span>
            </label>
            <label class="qcm-option">
                <input type="radio" name="q3" value="souplesse" onclick="saveAnswer('objectif', 'souplesse')">
                <span>ü§∏ Am√©liorer ma souplesse et ma posture</span>
            </label>
            <label class="qcm-option">
                <input type="radio" name="q3" value="perte" onclick="saveAnswer('objectif', 'perte')">
                <span>üî• Perdre du poids</span>
            </label>
        </div>
    </div>

    <div class="qcm-question">
        <h3>Question 4 : Avez-vous des douleurs ou blessures actuelles ?</h3>
        <div class="qcm-options">
            <label class="qcm-option">
                <input type="radio" name="q4" value="aucune" onclick="saveAnswer('douleur', 'aucune')">
                <span>‚úÖ Aucune douleur</span>
            </label>
            <label class="qcm-option">
                <input type="radio" name="q4" value="dos" onclick="saveAnswer('douleur', 'dos')">
                <span>üî¥ Douleurs au dos</span>
            </label>
            <label class="qcm-option">
                <input type="radio" name="q4" value="genoux" onclick="saveAnswer('douleur', 'genoux')">
                <span>üî¥ Douleurs aux genoux</span>
            </label>
            <label class="qcm-option">
                <input type="radio" name="q4" value="epaules" onclick="saveAnswer('douleur', 'epaules')">
                <span>üî¥ Douleurs aux √©paules</span>
            </label>
        </div>
    </div>

    <div style="text-align: center; margin-top: 3rem;">
        <button class="btn-decathlon" onclick="completeLevel1()">
            ‚úÖ Valider mon profil
        </button>
    </div>
</div>

<!-- NIVEAU 2 : INSTRUCTIONS -->
<div class="level-section" id="level-2">
    <h2 style="color: #FF6B35;">2Ô∏è‚É£ Niveau 2 : Instructions Personnalis√©es</h2>
    
    <div id="profile-result" class="profile-summary" style="display: none;">
        <h3>üìä Votre Profil Sportif</h3>
        <div id="profile-display"></div>
    </div>

    <div class="alert-posture">
        <span class="icon">‚ö†Ô∏è</span>
        <div>
            <strong>Important !</strong> Une mauvaise posture peut causer des blessures graves. 
            Suivez attentivement les instructions ci-dessous adapt√©es √† votre profil.
        </div>
    </div>

    <div class="exercise-card" id="exercise-squat">
        <h3>ü¶µ SQUAT (Flexion de Jambes)</h3>
        
        <div class="instruction-step">
            <strong>√âtape 1 : Position de d√©part</strong>
            <p>
                ‚Ä¢ Pieds √©cart√©s √† largeur d'√©paules<br>
                ‚Ä¢ Pointes de pieds l√©g√®rement vers l'ext√©rieur (10-15¬∞)<br>
                ‚Ä¢ Dos droit, regard devant vous<br>
                ‚Ä¢ Bras tendus devant ou crois√©s sur la poitrine
            </p>
        </div>

        <div class="instruction-step">
            <strong>√âtape 2 : Descente contr√¥l√©e</strong>
            <p>
                ‚Ä¢ Inspirez profond√©ment<br>
                ‚Ä¢ Poussez les fesses vers l'arri√®re (comme pour s'asseoir)<br>
                ‚Ä¢ Descendez jusqu'√† ce que les cuisses soient parall√®les au sol<br>
                ‚Ä¢ <span style="color: #E74C3C;">‚ùå NE PAS : genoux qui d√©passent les orteils</span><br>
                ‚Ä¢ <span style="color: #E74C3C;">‚ùå NE PAS : dos courb√©</span>
            </p>
        </div>

        <div class="instruction-step">
            <strong>√âtape 3 : Remont√©e puissante</strong>
            <p>
                ‚Ä¢ Expirez en poussant sur vos talons<br>
                ‚Ä¢ Contractez les fessiers et les abdominaux<br>
                ‚Ä¢ Remontez en gardant le dos droit<br>
                ‚Ä¢ Retour √† la position initiale
            </p>
        </div>

        <div class="instruction-step">
            <strong>üéØ R√©p√©titions recommand√©es pour vous</strong>
            <p id="squat-reps"></p>
        </div>
    </div>

    <div class="exercise-card" id="exercise-pushup">
        <h3>üí™ POMPES (Push-ups)</h3>
        
        <div class="instruction-step">
            <strong>√âtape 1 : Position de planche</strong>
            <p>
                ‚Ä¢ Mains au sol, largeur d'√©paules<br>
                ‚Ä¢ Corps align√© : t√™te, √©paules, hanches, pieds<br>
                ‚Ä¢ Abdominaux et fessiers contract√©s<br>
                ‚Ä¢ Regard vers le sol (nuque neutre)
            </p>
        </div>

        <div class="instruction-step">
            <strong>√âtape 2 : Descente</strong>
            <p>
                ‚Ä¢ Inspirez en pliant les coudes<br>
                ‚Ä¢ Coudes √† 45¬∞ du corps (pas √©cart√©s √† 90¬∞)<br>
                ‚Ä¢ Descendez jusqu'√† ce que le torse touche presque le sol<br>
                ‚Ä¢ <span style="color: #E74C3C;">‚ùå NE PAS : cambrer le dos</span><br>
                ‚Ä¢ <span style="color: #E74C3C;">‚ùå NE PAS : laisser tomber les hanches</span>
            </p>
        </div>

        <div class="instruction-step">
            <strong>√âtape 3 : Remont√©e</strong>
            <p>
                ‚Ä¢ Expirez en poussant fort<br>
                ‚Ä¢ Gardez le corps gain√© et align√©<br>
                ‚Ä¢ Extension compl√®te des bras<br>
                ‚Ä¢ Retour √† la position de planche
            </p>
        </div>

        <div class="instruction-step">
            <strong>üéØ Variante recommand√©e pour vous</strong>
            <p id="pushup-variant"></p>
        </div>
    </div>

    <div class="exercise-card" id="exercise-plank">
        <h3>üß± PLANCHE (Gainage)</h3>
        
        <div class="instruction-step">
            <strong>Position correcte</strong>
            <p>
                ‚Ä¢ Avant-bras au sol, coudes sous les √©paules<br>
                ‚Ä¢ Corps parfaitement align√© (ligne droite)<br>
                ‚Ä¢ Abdominaux et fessiers contract√©s<br>
                ‚Ä¢ Respiration r√©guli√®re<br>
                ‚Ä¢ <span style="color: #E74C3C;">‚ùå NE PAS : creuser le dos</span><br>
                ‚Ä¢ <span style="color: #E74C3C;">‚ùå NE PAS : lever les fesses</span>
            </p>
        </div>

        <div class="instruction-step">
            <strong>üéØ Dur√©e recommand√©e pour vous</strong>
            <p id="plank-duration"></p>
        </div>
    </div>

    <div style="text-align: center; margin-top: 3rem;">
        <button class="btn-decathlon" onclick="completeLevel2()">
            ‚úÖ J'ai compris les instructions
        </button>
    </div>
</div>

<!-- NIVEAU 3 : VISUALISATION -->
<div class="level-section" id="level-3">
    <h2 style="color: #FF6B35;">3Ô∏è‚É£ Niveau 3 : Illustration et Visualisation</h2>
    <p style="font-size: 1.1rem; color: #4A5568; margin-bottom: 2rem;">
        Visualisez les postures correctes vs incorrectes pour √©viter les blessures.
    </p>

    <h3 style="color: #2D3748; margin-bottom: 2rem;">ü¶µ SQUAT : Bonne vs Mauvaise Posture</h3>
    <div class="posture-visual">
        <div class="posture-image correct">
            <h4 style="color: #8BC34A;">‚úÖ POSTURE CORRECTE</h4>
            <svg class="posture-svg" viewBox="0 0 200 300">
                <!-- Bonne posture squat -->
                <line x1="100" y1="50" x2="100" y2="200" stroke="#8BC34A" stroke-width="3" stroke-dasharray="5,5"/>
                
                <!-- T√™te -->
                <circle cx="100" cy="40" r="15" fill="#FFDAB9"/>
                
                <!-- Corps -->
                <rect x="85" y="55" width="30" height="50" fill="#4A90E2" rx="5"/>
                
                <!-- Bras -->
                <line x1="85" y1="65" x2="60" y2="90" stroke="#FFDAB9" stroke-width="8" stroke-linecap="round"/>
                <line x1="115" y1="65" x2="140" y2="90" stroke="#FFDAB9" stroke-width="8" stroke-linecap="round"/>
                
                <!-- Jambes fl√©chies -->
                <line x1="90" y1="105" x2="70" y2="160" stroke="#2D3748" stroke-width="10" stroke-linecap="round"/>
                <line x1="110" y1="105" x2="130" y2="160" stroke="#2D3748" stroke-width="10" stroke-linecap="round"/>
                
                <!-- Genoux -->
                <circle cx="70" cy="160" r="8" fill="#8BC34A"/>
                <circle cx="130" cy="160" r="8" fill="#8BC34A"/>
                
                <!-- Bas jambes -->
                <line x1="70" y1="160" x2="60" y2="220" stroke="#2D3748" stroke-width="10" stroke-linecap="round"/>
                <line x1="130" y1="160" x2="140" y2="220" stroke="#2D3748" stroke-width="10" stroke-linecap="round"/>
                
                <!-- Pieds -->
                <ellipse cx="55" cy="230" rx="15" ry="8" fill="#654321"/>
                <ellipse cx="145" cy="230" rx="15" ry="8" fill="#654321"/>
                
                <!-- Annotations -->
                <text x="100" y="260" text-anchor="middle" fill="#8BC34A" font-size="12" font-weight="bold">
                    Dos droit
                </text>
                <text x="100" y="275" text-anchor="middle" fill="#8BC34A" font-size="12" font-weight="bold">
                    Genoux align√©s
                </text>
            </svg>
            <p style="color: #2D3748; line-height: 1.6;">
                ‚Ä¢ Dos droit et vertical<br>
                ‚Ä¢ Genoux align√©s avec les pieds<br>
                ‚Ä¢ Poids sur les talons<br>
                ‚Ä¢ Fesses pouss√©es vers l'arri√®re
            </p>
        </div>

        <div class="posture-image incorrect">
            <h4 style="color: #E74C3C;">‚ùå POSTURE INCORRECTE</h4>
            <svg class="posture-svg" viewBox="0 0 200 300">
                <!-- Mauvaise posture squat -->
                <line x1="100" y1="50" x2="120" y2="200" stroke="#E74C3C" stroke-width="3" stroke-dasharray="5,5"/>
                
                <!-- T√™te -->
                <circle cx="110" cy="40" r="15" fill="#FFDAB9"/>
                
                <!-- Corps pench√© -->
                <rect x="95" y="55" width="30" height="50" fill="#4A90E2" rx="5" transform="rotate(15 110 80)"/>
                
                <!-- Bras -->
                <line x1="95" y1="65" x2="70" y2="100" stroke="#FFDAB9" stroke-width="8" stroke-linecap="round"/>
                <line x1="125" y1="65" x2="150" y2="100" stroke="#FFDAB9" stroke-width="8" stroke-linecap="round"/>
                
                <!-- Jambes mal positionn√©es -->
                <line x1="100" y1="105" x2="80" y2="160" stroke="#2D3748" stroke-width="10" stroke-linecap="round"/>
                <line x1="120" y1="105" x2="140" y2="160" stroke="#2D3748" stroke-width="10" stroke-linecap="round"/>
                
                <!-- Genoux qui avancent (erreur) -->
                <circle cx="70" cy="165" r="8" fill="#E74C3C"/>
                <circle cx="130" cy="165" r="8" fill="#E74C3C"/>
                
                <!-- Bas jambes -->
                <line x1="70" y1="165" x2="50" y2="220" stroke="#2D3748" stroke-width="10" stroke-linecap="round"/>
                <line x1="130" y1="165" x2="110" y2="220" stroke="#2D3748" stroke-width="10" stroke-linecap="round"/>
                
                <!-- Pieds -->
                <ellipse cx="45" cy="230" rx="15" ry="8" fill="#654321"/>
                <ellipse cx="115" cy="230" rx="15" ry="8" fill="#654321"/>
                
                <!-- Annotations -->
                <text x="110" y="260" text-anchor="middle" fill="#E74C3C" font-size="12" font-weight="bold">
                    Dos courb√©
                </text>
                <text x="110" y="275" text-anchor="middle" fill="#E74C3C" font-size="12" font-weight="bold">
                    Genoux en avant
                </text>
            </svg>
            <p style="color: #2D3748; line-height: 1.6;">
                ‚Ä¢ ‚ùå Dos courb√© en avant<br>
                ‚Ä¢ ‚ùå Genoux qui d√©passent les orteils<br>
                ‚Ä¢ ‚ùå Poids sur l'avant du pied<br>
                ‚Ä¢ ‚ùå Risque de blessure au dos et genoux
            </p>
        </div>
    </div>

    <h3 style="color: #2D3748; margin: 3rem 0 2rem;">üí™ POMPES : Bonne vs Mauvaise Posture</h3>
    <div class="posture-visual">
        <div class="posture-image correct">
            <h4 style="color: #8BC34A;">‚úÖ POSTURE CORRECTE</h4>
            <svg class="posture-svg" viewBox="0 0 300 200">
                <!-- Bonne posture pompe (corps align√©) -->
                <line x1="50" y1="100" x2="250" y2="100" stroke="#8BC34A" stroke-width="3" stroke-dasharray="5,5"/>
                
                <!-- T√™te -->
                <circle cx="70" cy="100" r="15" fill="#FFDAB9"/>
                
                <!-- Corps align√© -->
                <rect x="85" y="90" width="150" height="20" fill="#4A90E2" rx="5"/>
                
                <!-- Bras -->
                <line x1="100" y1="100" x2="100" y2="140" stroke="#FFDAB9" stroke-width="10" stroke-linecap="round"/>
                <line x1="220" y1="100" x2="220" y2="140" stroke="#FFDAB9" stroke-width="10" stroke-linecap="round"/>
                
                <!-- Mains -->
                <ellipse cx="100" cy="145" rx="12" ry="8" fill="#FFDAB9"/>
                <ellipse cx="220" cy="145" rx="12" ry="8" fill="#FFDAB9"/>
                
                <!-- Jambes -->
                <rect x="235" y="95" width="15" height="10" fill="#2D3748"/>
                
                <text x="150" y="70" text-anchor="middle" fill="#8BC34A" font-size="14" font-weight="bold">
                    Alignement parfait
                </text>
            </svg>
            <p style="color: #2D3748; line-height: 1.6;">
                ‚Ä¢ Corps parfaitement align√©<br>
                ‚Ä¢ Coudes √† 45¬∞ du corps<br>
                ‚Ä¢ Abdos et fessiers gain√©s<br>
                ‚Ä¢ Nuque neutre, regard au sol
            </p>
        </div>

        <div class="posture-image incorrect">
            <h4 style="color: #E74C3C;">‚ùå POSTURE INCORRECTE</h4>
            <svg class="posture-svg" viewBox="0 0 300 200">
                <!-- Mauvaise posture pompe (dos cambr√©) -->
                <path d="M 50 100 Q 150 80 250 120" stroke="#E74C3C" stroke-width="3" stroke-dasharray="5,5" fill="none"/>
                
                <!-- T√™te -->
                <circle cx="70" cy="95" r="15" fill="#FFDAB9"/>
                
                <!-- Corps cambr√© -->
                <path d="M 85 95 Q 160 75 235 115" fill="#4A90E2" stroke="#4A90E2" stroke-width="20"/>
                
                <!-- Bras -->
                <line x1="100" y1="90" x2="100" y2="140" stroke="#FFDAB9" stroke-width="10" stroke-linecap="round"/>
                <line x1="220" y1="105" x2="220" y2="145" stroke="#FFDAB9" stroke-width="10" stroke-linecap="round"/>
                
                <!-- Mains -->
                <ellipse cx="100" cy="145" rx="12" ry="8" fill="#FFDAB9"/>
                <ellipse cx="220" cy="150" rx="12" ry="8" fill="#FFDAB9"/>
                
                <text x="150" y="50" text-anchor="middle" fill="#E74C3C" font-size="14" font-weight="bold">
                    Dos cambr√©
                </text>
            </svg>
            <p style="color: #2D3748; line-height: 1.6;">
                ‚Ä¢ ‚ùå Dos cambr√© (lordose)<br>
                ‚Ä¢ ‚ùå Hanches qui tombent<br>
                ‚Ä¢ ‚ùå Coudes trop √©cart√©s<br>
                ‚Ä¢ ‚ùå Risque de blessure lombaire
            </p>
        </div>
    </div>

    <div class="video-placeholder">
        üé• Vid√©o d√©monstration : Mouvements en temps r√©el
        <br>
        <small>(√Ä venir - int√©gration vid√©o YouTube/Decathlon)</small>
    </div>

    <div style="text-align: center; margin-top: 3rem;">
        <button class="btn-decathlon" onclick="completeLevel3()">
            ‚úÖ J'ai visualis√© les postures
        </button>
    </div>
</div>

<!-- NIVEAU 4 : PRODUITS DECATHLON -->
<div class="level-section" id="level-4">
    <h2 style="color: #FF6B35;">4Ô∏è‚É£ Niveau 4 : Produits Decathlon Recommand√©s</h2>
    <p style="font-size: 1.1rem; color: #4A5568; margin-bottom: 2rem;">
        √âquipez-vous avec les meilleurs produits pour votre pratique sportive !
    </p>

    <h3 style="color: #2D3748;">üõçÔ∏è S√©lection personnalis√©e pour votre profil</h3>
    
    <div class="product-grid" id="product-recommendations">
        <!-- Produits g√©n√©r√©s dynamiquement selon le profil -->
    </div>

    <div style="text-align: center; margin-top: 3rem;">
        <a href="https://www.decathlon.fr" target="_blank" class="btn-decathlon" style="font-size: 1.2rem; padding: 1.5rem 3rem;">
            üõí D√©couvrir plus sur Decathlon.fr
        </a>
    </div>

    <div style="background: linear-gradient(135deg, #4A90E2, #357ABD); color: white; padding: 3rem; border-radius: 20px; margin-top: 3rem; text-align: center;">
        <h2 style="color: white;">üéâ F√©licitations !</h2>
        <p style="font-size: 1.2rem; margin: 1.5rem 0;">
            Vous avez compl√©t√© les 4 niveaux du d√©fi Decathlon !
        </p>
        <p style="font-size: 1.1rem;">
            Vous √™tes maintenant le <strong>CTO de votre sant√© posturale</strong> üí™
        </p>
        <div style="margin-top: 2rem;">
            <a href="/" class="btn-decathlon" style="background: white; color: #FF6B35;">
                ‚Üê Retour √† NIRD Quest
            </a>
        </div>
    </div>
</div>

<script>
// DONN√âES UTILISATEUR
let userProfile = {
    niveau: null,
    sports: [],
    objectif: null,
    douleur: null
};

// NIVEAU 1 : Sauvegarde des r√©ponses
function saveAnswer(key, value) {
    userProfile[key] = value;
    localStorage.setItem('posture_profile', JSON.stringify(userProfile));
    
    // Feedback visuel
    event.target.closest('.qcm-option').classList.add('selected');
    event.target.closest('.qcm-question').querySelectorAll('.qcm-option').forEach(opt => {
        if (opt !== event.target.closest('.qcm-option')) {
            opt.classList.remove('selected');
        }
    });
}

function saveSport(sport) {
    if (event.target.checked) {
        userProfile.sports.push(sport);
    } else {
        userProfile.sports = userProfile.sports.filter(s => s !== sport);
    }
    localStorage.setItem('posture_profile', JSON.stringify(userProfile));
    event.target.closest('.qcm-option').classList.toggle('selected');
}

function completeLevel1() {
    // V√©rifier que tout est rempli
    if (!userProfile.niveau || !userProfile.objectif || !userProfile.douleur) {
        alert('‚ö†Ô∏è Veuillez r√©pondre √† toutes les questions avant de continuer.');
        return;
    }
    
    if (userProfile.sports.length === 0) {
        alert('‚ö†Ô∏è Veuillez s√©lectionner au moins un sport.');
        return;
    }
    
    // Marquer comme compl√©t√©
    document.getElementById('btn-level-2').classList.add('completed');
    
    // Afficher niveau 2
    showLevel(2);
    
    // G√©n√©rer les recommandations personnalis√©es
    generateInstructions();
}

// NIVEAU 2 : G√©n√©ration d'instructions personnalis√©es
function generateInstructions() {
    const profile = userProfile;
    
    // Afficher le profil
    document.getElementById('profile-result').style.display = 'block';
    document.getElementById('profile-display').innerHTML = `
        <p><strong>Niveau :</strong> ${profile.niveau}</p>
        <p><strong>Sports :</strong> ${profile.sports.join(', ')}</p>
        <p><strong>Objectif :</strong> ${profile.objectif}</p>
        <p><strong>Douleurs :</strong> ${profile.douleur === 'aucune' ? 'Aucune' : profile.douleur}</p>
    `;
    
    // Adapter les r√©p√©titions selon le niveau
    let squatReps, pushupVariant, plankDuration;
    
    if (profile.niveau === 'debutant') {
        squatReps = '3 s√©ries de 10 r√©p√©titions';
        pushupVariant = 'Pompes sur les genoux : 3 s√©ries de 8 r√©p√©titions';
        plankDuration = '3 s√©ries de 20 secondes';
    } else if (profile.niveau === 'intermediaire') {
        squatReps = '4 s√©ries de 15 r√©p√©titions';
        pushupVariant = 'Pompes classiques : 4 s√©ries de 12 r√©p√©titions';
        plankDuration = '3 s√©ries de 45 secondes';
    } else {
        squatReps = '5 s√©ries de 20 r√©p√©titions (avec poids si possible)';
        pushupVariant = 'Pompes d√©clin√©es : 4 s√©ries de 15 r√©p√©titions';
        plankDuration = '4 s√©ries de 60 secondes';
    }
    
    // Adapter selon les douleurs
    if (profile.douleur === 'genoux') {
        squatReps += ' (Amplitude r√©duite si douleur)';
    }
    if (profile.douleur === 'dos') {
        plankDuration += ' (Surveiller l\'alignement)';
    }
    if (profile.douleur === 'epaules') {
        pushupVariant += ' (R√©duire l\'amplitude)';
    }
    
    document.getElementById('squat-reps').textContent = squatReps;
    document.getElementById('pushup-variant').textContent = pushupVariant;
    document.getElementById('plank-duration').textContent = plankDuration;
}

function completeLevel2() {
    document.getElementById('btn-level-3').classList.add('completed');
    showLevel(3);
}

function completeLevel3() {
    document.getElementById('btn-level-4').classList.add('completed');
    showLevel(4);
    generateProducts();
}

// NIVEAU 4 : G√©n√©ration de produits personnalis√©s
function generateProducts() {
    const profile = userProfile;
    const container = document.getElementById('product-recommendations');
    
    let products = [];
    
    // Produits selon les sports
    if (profile.sports.includes('musculation')) {
        products.push({
            name: 'Kit Halt√®res R√©glables',
            price: '49.99‚Ç¨',
            icon: 'üèãÔ∏è',
            desc: 'De 2 √† 10kg, parfait pour d√©buter'
        });
        products.push({
            name: 'Tapis de Protection Sol',
            price: '29.99‚Ç¨',
            icon: '‚¨õ',
            desc: 'Prot√®ge votre sol et amortit'
        });
    }
    
    if (profile.sports.includes('yoga')) {
        products.push({
            name: 'Tapis de Yoga 5mm',
            price: '24.99‚Ç¨',
            icon: 'üßò',
            desc: 'Antid√©rapant et confortable'
        });
        products.push({
            name: 'Bloc de Yoga (x2)',
            price: '12.99‚Ç¨',
            icon: 'üü¶',
            desc: 'Am√©liore votre souplesse'
        });
    }
    
    if (profile.sports.includes('course')) {
        products.push({
            name: 'Chaussures Running',
            price: '79.99‚Ç¨',
            icon: 'üëü',
            desc: 'Amorti optimal, l√©g√®res'
        });
    }
    
    // Produits g√©n√©riques recommand√©s
    products.push({
        name: 'Bandes de R√©sistance (Set)',
        price: '14.99‚Ç¨',
        icon: 'üéóÔ∏è',
        desc: '3 niveaux de r√©sistance'
    });
    
    products.push({
        name: 'Rouleau de Massage',
        price: '19.99‚Ç¨',
        icon: 'üîµ',
        desc: 'R√©cup√©ration musculaire'
    });
    
    if (profile.douleur !== 'aucune') {
        products.push({
            name: 'Ceinture de Maintien Lombaire',
            price: '34.99‚Ç¨',
            icon: 'ü©π',
            desc: 'Prot√®ge votre dos'
        });
    }
    
    // G√©n√©rer le HTML
    container.innerHTML = products.map(p => `
        <div class="product-card">
            <div class="product-image">${p.icon}</div>
            <h4 style="color: #2D3748; margin-bottom: 0.5rem;">${p.name}</h4>
            <p style="color: #718096; font-size: 0.9rem;">${p.desc}</p>
            <div class="product-price">${p.price}</div>
            <a href="https://www.decathlon.fr" target="_blank" class="btn-decathlon">
                Voir sur Decathlon
            </a>
        </div>
    `).join('');
}

// NAVIGATION NIVEAUX
function showLevel(level) {
    // Cacher tous les niveaux
    document.querySelectorAll('.level-section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('active'));
    
    // Afficher le niveau demand√©
    document.getElementById(`level-${level}`).classList.add('active');
    document.querySelector(`[onclick="showLevel(${level})"]`).classList.add('active');
    
    // Scroll to top
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

// CHARGEMENT DES DONN√âES SAUVEGARD√âES
window.addEventListener('DOMContentLoaded', () => {
    const saved = localStorage.getItem('posture_profile');
    if (saved) {
        userProfile = JSON.parse(saved);
        
        // Restaurer les s√©lections
        if (userProfile.niveau) {
            const radio = document.querySelector(`input[value="${userProfile.niveau}"]`);
            if (radio) {
                radio.checked = true;
                radio.closest('.qcm-option').classList.add('selected');
            }
        }
        
        userProfile.sports.forEach(sport => {
            const checkbox = document.querySelector(`input[value="${sport}"]`);
            if (checkbox) {
                checkbox.checked = true;
                checkbox.closest('.qcm-option').classList.add('selected');
            }
        });
        
        // Autres champs...
    }
});
</script>
{% endblock %}
